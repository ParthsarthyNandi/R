---
title: "Lecture 7"
author: "Parthsarthy Nandi"
date: "2023-02-21"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
download.file("http://www.openintro.org/stat/data/nc.RData", destfile = "nc.RData")
load("nc.RData")
names(nc)
```

#On your own

#1.Calculate a 95% confidence interval for the average length of
#pregnancies (weeks) and interpret it in context. Note that since 
#you're doing inference on a single population parameter, 
#there is no explanatory variable, so you can omit the x variable from the function.
```{r}
 inference(y = nc$weeks, est = "mean", type = "ci", null = 0,
            alternative = "twosided", method = "theoretical")
```

#2.Calculate a new confidence interval for the same parameter at the 90% confidence level. You can change the confidence level by adding a new argument to the function: conflevel = 0.90.
```{r}
 inference(y = nc$weeks, est = "mean", type = "ci", null = 0,
             alternative = "twosided", method = "theoretical", conflevel = 0.90)
```

#3.Conduct a hypothesis test evaluating whether the average weight gained by younger mothers is different than the average weight gained by mature mothers.
```{r}
inference(y = nc$weight, x = nc$mature, est = "mean", type = "ht", null = 0,
alternative = "twosided", method = "theoretical",
order = c("younger mom","mature mom"))
```

#4.Now, a non-inference task: Determine the age cutoff for younger and mature mothers. Use a method of your choice, and explain how your method works.
```{r}
library(magrittr) 
library(dplyr) 
nc %>% group_by(mature) %>% na.omit() %>%
 summarise(min_age = min(mage),
 max_age = max(mage))
```

#5.Pick a pair of numerical and categorical variables and come up with a research question evaluating the relationship between these variables. Formulate the question in a way that it can be answered using a hypothesis test and/or a confidence interval. Answer your question using the inference function, report the statistical results, and also provide an explanation in plain language.
    
    I have checked smoking habit with weight gained by the mother.
    H0:Mother's smoking habit has no effect on weight gain.
    H1:Mother's smoking habit has an effect on weight gain.
```{r}
inference(y = nc$gained, x = nc$habit, est = "mean", type = "ht", null = 0,
alternative = "twosided", method = "theoretical", order = c("smoker","nonsmoker"))
```

    We can see p-value is 0.2214>0.05 hence we can reject H1.

  

